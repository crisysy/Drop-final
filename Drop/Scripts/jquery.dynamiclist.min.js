!function(e){var t={addItem:function(n,i){n&&n.preventDefault(),i.addButton.prop("disabled",!0);var a=t.getNewIndex(i.list,i.itemSelector),d=t.getNewItemPrefix(i.htmlFieldPrefix,i.property,a),o="function"==typeof i.newItemUrl?i.newItemUrl():i.newItemUrl;o.indexOf("?")<0&&(o+="?"),e.get(o+"&htmlFieldPrefix="+d,function(n){if("table"===i.listType)i.list.find("tbody").append(n),i.list.find(i.itemSelector+":last").append("<td class='delete-cell'>");else{var d=i.list.find(i.itemSelector+":last");d.length>0?d.after(n):i.list.prepend(n)}var o=e(i.itemSelector+":last",i.list),r=t.getIndexName(i.htmlFieldPrefix,i.property);t.appendRemoveAndIndex(o,a,r,i),e.validator&&e.validator.unobtrusive&&e.validator.unobtrusive.parseDynamicContent&&e.validator.unobtrusive.parseDynamicContent(o),i.itemAdded&&i.itemAdded(o),i.addButton.prop("disabled",!1)}).fail(function(e){if(401===e.status){var t="Your session has timed out. Please refresh the page and try again.";console&&console.log?console.log(t):alert(t)}})},removeItem:function(e,t){if(!t.removeConfirmation||confirm(t.removeConfirmation)){var n=$(e);t.itemRemoved&&t.itemRemoved(n),n.remove()}},appendRemoveAndIndex:function(n,i,a,d){var o=t.parseTemplate("removeItem",d),r='<input type="hidden" name="'+a+'" class="index" value="'+i+'" />',l=o+r;"table"===d.listType?n.find("td.delete-cell").append(l):n.append(l),e(".delete-item",n).click(function(e){e.preventDefault(),t.removeItem(n,d)})},getBaseItemPrefix:function(e,t){var n=e;return""!==n&&(n+="."),n+=t},getNewItemPrefix:function(e,n,i){return t.getBaseItemPrefix(e,n)+"["+i+"]"},getIndexName:function(e,n){return t.getBaseItemPrefix(e,n)+".Index"},getNewIndex:function(t,n){var i=e(n,t);if(0===i.length)return 0;var a=0;return i.each(function(){var t=parseInt(e("input.index",e(this)).val());isNaN(t)&&(t=0),a=Math.max(a,t)}),a+1},getTemplate:function(e,t){return t.templates[t.listType][e]},parseTemplate:function(e,n){var i=t.getTemplate(e,n);return Object.keys(n).forEach(function(e){i=i.replace("{"+e+"}",n[e]||"")}),i}},n={init:function(n){return n=e.extend({},e.fn.dynamiclist.defaults,n),this.each(function(){var i=e(this),a=i.data("dynamiclist");if(n.list=i,!a){i.wrap(t.parseTemplate("container",n)),i.addClass("dynamic-list"),n.selector=i.selector,"table"===n.listType&&(e("thead tr",i).append("<th></th>"),e("tbody tr",i).append("<td class='delete-cell'></td>"),e("tfoot tr",i).append("<td></td>")),e(n.itemSelector,i).each(function(i){var a=t.getIndexName(n.htmlFieldPrefix,n.property);t.appendRemoveAndIndex(e(this),i,a,n)});var d=t.parseTemplate("addItem",n);if("table"===n.listType){var o=i.find("thead td, thead th").length,r=i.find("tfoot");0===r.length&&(i.append("<tfoot></tfoot>"),r=i.find("tfoot")),r.append('<tr><td colspan="'+o+'">'+d+"</td></tr>")}else i.append(d);var l=n.addButton=i.find(".add-item");l.click(function(e){t.addItem(e,n)}),i.data("dynamiclist",n),n.itemAdded&&$(n.itemSelector,i).each(function(e,t){n.itemAdded(t)})}})},options:function(t){return this.each(function(){var n=e(this),i=n.data("dynamiclist")||{};t=e.extend({},i,t),n.dynamiclist("destroy").dynamiclist("init",t)})},add:function(){return this.each(function(){var n=e(this);t.addItem(null,n.data("dynamiclist"))})},remove:function(e){var n=$(e),i=$(e).parents(".dynamic-list"),a=i.data("dynamiclist");t.removeItem(n,a)},destroy:function(){return this.each(function(){var t=e(this);t.removeData("dynamiclist")})}};e.fn.dynamiclist=function(t){return n[t]?n[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.dynamiclist"):n.init.apply(this,arguments)},e.fn.dynamiclist.defaults={itemSelector:".item",addLabel:"Add",removeLabel:"Remove",htmlFieldPrefix:"",property:"Items",newItemUrl:"NewItem",listType:"list",itemAdded:function(e){},itemRemoved:function(e){},removeConfirmation:null,templates:{table:{container:"<div class='dynamic-list-container'></div>",addItem:'<div class="add-item-container"><button class="add-item">{addLabel}</button></div>',removeItem:'<button type="button" class="delete-item">{removeLabel}</button>'},list:{container:"<div class='dynamic-list-container'></div>",addItem:'<li class="add-item-container"><button class="add-item">{addLabel}</button></li>',removeItem:'<button type="button" class="delete-item">{removeLabel}</button>'},div:{container:"<div class='dynamic-list-container'></div>",addItem:'<div class="add-item-container"><button class="add-item">{addLabel}</button></div>',removeItem:'<button type="button" class="delete-item">{removeLabel}</button>'}}}}(jQuery);
//# sourceMappingURL=jquery.dynamiclist.min.js.map
